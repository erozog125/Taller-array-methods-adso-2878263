<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulario de Personas</title>
    <link rel="stylesheet" href="assets/Styles/character.css">
</head>
<body>

    <h1>Formulario de Personas</h1>
    <nav>
        <a href="index.html">INICIO</a>
    </nav>

    <div id="person-form">
        <input type="text" id="name" placeholder="Nombre" required>
        <input type="text" id="surname" placeholder="Apellido" required>
        <input type="number" id="age" placeholder="Edad" required>
        <select id="gender" required>
            <option value="">Género</option>
            <option value="Masculino">Masculino</option>
            <option value="Femenino">Femenino</option>
            <option value="">otros 120 tipos de gay</option>
        </select>
        <input type="text" id="bloodType" placeholder="Tipo de Sangre" required>
        <input type="file" id="image" accept="image/*">
        <button onclick="savePerson()">Guardar</button>
        <button onclick="editPerson()">Editar</button>
        <button onclick="listPersons()">Listar</button>
    </div>

    <div id="persons-container"></div>

    <script>
        let persons = [];
        let currentEditId = null;

        // Función para guardar o actualizar una persona
        function savePerson() {
            const name = document.getElementById('name').value.trim();
            const surname = document.getElementById('surname').value.trim();
            const age = document.getElementById('age').value.trim();
            const gender = document.getElementById('gender').value;
            const bloodType = document.getElementById('bloodType').value.trim();
            const imageInput = document.getElementById('image');

            // Validar que todos los campos obligatorios tengan un valor
            if (!name || !surname || !age || !gender || !bloodType) {
                alert('Por favor, complete todos los campos obligatorios.');
                return;
            }

            let image;
            if (imageInput.files.length > 0) {
                image = URL.createObjectURL(imageInput.files[0]);
            }

            if (currentEditId) {
                // Actualizar
                const personIndex = persons.findIndex(p => p.id === currentEditId);
                if (personIndex !== -1) {
                    persons[personIndex] = {
                        id: currentEditId,
                        name,
                        surname,
                        age,
                        gender,
                        bloodType,
                        image: image || persons[personIndex].image
                    };
                    alert('Persona actualizada con éxito');
                }
                currentEditId = null;
            } else {

                const person = {
                    id: persons.length + 1,
                    name,
                    surname,
                    age,
                    gender,
                    bloodType,
                    image
                };
                persons.push(person);
                alert('Persona guardada con éxito');
            }

            clearForm();
            listPersons();
        }

        function listPersons() {
            const container = document.getElementById('persons-container');
            container.innerHTML = '';
            persons.forEach(person => {
                const personCard = document.createElement('div');
                personCard.className = 'card';
                personCard.innerHTML = `
                    <img src="${person.image}" alt="${person.name}">
                    <div>
                        <strong>${person.name} ${person.surname}</strong><br>
                        Edad: ${person.age}<br>
                        Género: ${person.gender}<br>
                        Tipo de Sangre: ${person.bloodType}<br>
                        ID: ${person.id}
                    </div>
                `;
                container.appendChild(personCard);
            });
        }

        // Función para editar una persona
        function editPerson() {
            const id = prompt('Ingrese el ID de la persona que desea editar:');
            const person = persons.find(p => p.id == id);

            if (person) {
                document.getElementById('name').value = person.name;
                document.getElementById('surname').value = person.surname;
                document.getElementById('age').value = person.age;
                document.getElementById('gender').value = person.gender;
                document.getElementById('bloodType').value = person.bloodType;
                currentEditId = person.id;
                alert('Los campos han sido llenados. Realice los cambios y presione "Guardar" para actualizar.');
            } else {
                alert('Persona no existe');
            }
        }

        // Función para limpiar el formulario
        function clearForm() {
            document.getElementById('name').value = '';
            document.getElementById('surname').value = '';
            document.getElementById('age').value = '';
            document.getElementById('gender').value = '';
            document.getElementById('bloodType').value = '';
            document.getElementById('image').value = '';
        }
    </script>

</body>
</html>